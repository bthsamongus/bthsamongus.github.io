!function(){firebase.initializeApp({apiKey:"AIzaSyBQQPdSR_XQ8vW5ud0rKCkZqrNnrcC8jQs",authDomain:"bthsamongus.firebaseapp.com",databaseURL:"https://bthsamongus.firebaseio.com",projectId:"bthsamongus",storageBucket:"bthsamongus.appspot.com",messagingSenderId:"958186855973",appId:"1:958186855973:web:96ea662fa0b3464f0da9cc"});const e=firebase.database();function t(){(r=function(){function e(e){const t=document.createElement("input");for(const n in e)t.setAttribute(n,e[n]);return t}function t(e,t){const n=document.createElement("div");for(const t in e)n.setAttribute(t,e[t]);for(const e of t)n.appendChild(e);return n}function n(e,t,n){const a=document.createElement("label");for(const t in e)a.setAttribute(t,e[t]);if(n){const e=document.createElement("span");e.innerHTML=t;for(const t of[n,e])a.appendChild(t)}else a.innerHTML=t;return a}const a=document.querySelector(".main .form .content");a.innerHTML="";const r=[e({type:"text",placeholder:"first name",required:""}),e({type:"text",placeholder:"last name",required:""}),e({type:"email",placeholder:"email",required:""}),e({type:"number",placeholder:"osis",min:"100000000",max:"999999999",required:""}),e({type:"radio",name:"sgo",value:"y",required:""}),e({type:"radio",name:"sgo",value:"n",required:""}),e({type:"submit",value:"submit attendance form"})];for(const e of[t({class:"input"},r.slice(0,4)),t({class:"sgo"},[n({for:"sgo"},"have sgo sticker? &#x1f921;"),t({},[n({},"yes",r[4])]),t({},[n({},"no",r[5])])]),t({class:"submit"},[r[6]])])a.appendChild(e);return r}())[r.length-1].onclick=a}function n(e,t,n){const a=[document.querySelector(".main .status"),document.querySelector(".main .status .content"),document.querySelector(".main .status .content h1"),document.querySelector(".main .status .content p")];a[0].style.display="block",a[1].style.backgroundColor=n||"#ffd8d8",a[2].innerHTML=e||"error",a[3].innerHTML=t||"there was an error processing your form submission. please try again."}function a(a){a.preventDefault(),document.querySelector(".main .note").style.display="none",document.querySelector(".main .status").style.display="none";const o=function(e){for(const t of e)if(!t.checkValidity())return[!1,`please check in your input for ${t.placeholder}.`];return[!0,e.map(e=>e.value.trim())]}(r.slice(0,4)),i=function(e){for(const t of e)if(t.checked)return[!0,t.value];return[!1,"please indicate whether or not you have a sgo sticker."]}(r.slice(4,6));if(!o[0])return n("invalid input",o[1]);if(!i[0])return n("invalid input",i[1]);const s=new Date,c=[...o[1],i[1],s.getTime(),s.get12AMTime()].map(e=>e+""),u={};for(const e of c)u["firstname,lastname,email,osis,sgo,timestamp,date".split(",")[c.indexOf(e)]]=e;!async function(a){if((await e.ref("dates").once("value").then(e=>Object.values(e.val()))).filter(e=>a.date==e.date).length<1)return n("invalid time","we are currently not accepting attendance forms");if((await e.ref("logs").once("value").then(e=>Object.values(e.val()))).filter(e=>a.osis==e.osis&&a.date==e.date).length>0)return n("duplicate error","an attendance form for today using the provided osis already exists.");function r(e){n("database error "+e,"please screenshot this whole page and send it to any exec to have your attendance counted")}if(!await e.ref("logs").push({date:a.date,osis:a.osis,timestamp:a.timestamp},e=>!e))return r(0);if(!await e.ref("meta/logs").update({updated:a.timestamp}).then(()=>!0).catch(e=>!1))return r(1);if(!await e.ref("entries").push(a,e=>!e))return r(2);if(!await e.ref("meta/entries").update({updated:a.timestamp}).then(()=>!0).catch(e=>!1))return r(3);n("success","we have successfully recieved your attendance form. have fun!","#c0f793"),t()}(u)}let r;Date.prototype.get12AMTime||(Date.prototype.get12AMTime=function(){let e=(this.toString()+"").split(" ");return e[4]="00:00:00",new Date(e.join(" ")).getTime()}),t()}();